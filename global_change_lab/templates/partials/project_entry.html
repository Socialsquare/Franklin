{% load gcl_utils %}
{% load embed_video_tags %}

<div class="project" id="project-{{ project.id }}">
  {% if not hide_links %}<a href="{{ project.get_absolute_url }}">{% endif %}
    <h6 class="project-title">{{ project.name }}</h6><span class="date">{{ project.created_at|pretty_timesince }}</span>
  {% if not hide_links %}</a>{% endif %}

  <div class="content">
    <p>{{ project.content }}</p>
    <div class="gradient"></div>
  </div>
  <a href="#" class="expand">Read more...</a>
  <!-- <div class="hider"><a href="#" class="collapse">Collapse text</a></div> -->
  {% if project.image %}
  <ul class="clearing-thumbs" data-clearing>
    <li><a href="{{ project.image.url }}"><img class="project-image" data-caption="{{ project.name }}" src="{{ project.image.url }}"></a></li>
  </ul>
  {% endif %}

  {% if project.link %}
  <a href="{{ project.link }}">Hello</a>
  {% endif %}

  {% if project.video %}
    {% video project.video %}
  {% endif %}

  {% if not hide_user %}
  <div class="user-bar">
    <img class="profile-picture" src="{{ project.author.getImage }}">
    <a href="{% url 'profile' project.author.id %}" class="author">{{ project.author.username }}</a>
    <br>
    <div class="metadata">
      <span class="icon heart red"></span><span class="count">{{ project.like_set.count }}</span>
      <span class="icon chat red"></span><span class="count">{{ project.comment_set.count }}</span>
    </div>
  </div>
  {% endif %}

  {% if not hide_comments %}
    {# Comments section #}
    <div class="comments">
      {% include 'skills/partials/comment_list.html' with comments=project.root_comments %}
      <div class="comment-form">
        <form action="{% url 'skills:comment_post' %}" method="POST">
          {% csrf_token %}
          <input type="hidden" name="project" value="{{ project.pk }}">
          <textarea class="comment" name="text" placeholder="Write a comment..."></textarea>
          <button class="small">Comment</button>
        </form>
      </div>
    </div>
  {% endif %}
</div>
