{% load gcl_utils %}
{% load permissionif %}

<div class="comment gcl-object" style="margin-left:{{ comment.level }}rem;" id="comment-{{comment.id}}">

  <div class="headline">
    <img src="{{ comment.author.getImage }}">
    <a href="{% url 'profile' comment.author.id %}" class="author">{{ comment.author.username }}</a>
    <span class="date">{{ comment.created_at|pretty_timesince }}</span>

    <div class="moderation">
      {# Delete comment button #}
      {% permission request.user has 'skills.delete_comment' of comment %}
      <a href="{% url 'skills:comment_delete' comment.id %}" class="alert soft-delete" data-dropdown="comment-delete-dropdown-{{comment.id}}">Delete</a>
      {% endpermission %}

      {# Flag comment button #}
      {% comment %}
      {#<a href="{% url 'comments-flag' comment.id %}" class="flag" data-dropdown="comment-flag-dropdown-{{comment.id}}">Flag comment</a>#}
      <div id="comment-flag-dropdown-{{comment.id}}" class="f-dropdown" data-dropdown-content>
        <h6>Really flag this comment?</h6>
        {#<form action="{% url 'comments-flag' comment.id %}" method="post">{% csrf_token %}#}
          {% if next %}<div><input type="hidden" name="next" value="{{ next }}" id="next" /></div>{% endif %}
          <p class="submit">
            <input type="submit" name="submit" class="button" value="Flag" />
            <a href="{{ comment.get_absolute_url }}" class="button close info">cancel</a>
          </p>
        </form>
      </div>
      {% endcomment %}
    </div>
  </div>

    {% if comment.is_deleted %}
    <span class="icon block"></span>
    {% else %}
    {% if maxchars %}
    <p class="content">{{ comment.text|truncatechars:maxchars }}</p>
    {% else %}
    <p class="content">{{ comment.text }}</p>
    {% endif %}
    {% endif %}


    {# Reply to comment button #}
    {% if not hide_reply %}
    {% if comment.allow_thread %}<a href="{% url 'skills:comment_post' %}" data-parent-pk="{{ comment.pk }}" class="reply">Reply</a>{% endif %}
    {% endif %}

    {% if show_project %}
    <div class="from">
      commented on <a href="{{ comment.project.get_absolute_url }}"><h6 class="project-title">{{ comment.project.name|truncatechars:30 }}</h6></a>
    </div>
    {% endif %}
  <!-- </div> -->


</div>
